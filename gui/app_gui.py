import tkinter as tkfrom tkinter import ttkimport osfrom datetime import datetimefrom models.task import Taskclass ToDoGUI:    def __init__(self, root, toDoManager):        self.root = root        self.root.title("To-Do List Manager")        self.toDoManager = toDoManager        # Set application icon        icon_path = os.path.join("assets", "icon.png")        icon_image = tk.PhotoImage(file=icon_path)        self.root.iconphoto(True, icon_image)        self.build_interface()    def build_interface(self):        # ==========================        # Notebook (Tabs)        # ==========================        notebook = ttk.Notebook(self.root)        notebook.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)        # ==========================        # Tab 1: Add Task        # ==========================        add_tab = ttk.Frame(notebook)        notebook.add(add_tab, text="Add Task")        tk.Label(add_tab, text="Task Title:").grid(row=0, column=0, padx=10, pady=(10, 0), sticky="w")        self.title_entry = tk.Entry(add_tab, width=30)        self.title_entry.grid(row=1, column=0, padx=10, pady=5)        tk.Label(add_tab, text="Priority:").grid(row=2, column=0, padx=10, pady=(10, 0), sticky="w")        self.priority_var = tk.StringVar()        self.priority_dropdown = ttk.Combobox(            add_tab,            textvariable=self.priority_var,            values=["High", "Medium", "Low"],            state="readonly",            width=27        )        self.priority_dropdown.grid(row=3, column=0, padx=10, pady=5)        self.priority_dropdown.current(1)        tk.Button(            add_tab,            text="Add Task",            width=25,            command=self.add_task        ).grid(row=4, column=0, padx=10, pady=15)        # ==========================        # Tab 2: Task List        # ==========================        list_tab = ttk.Frame(notebook)        notebook.add(list_tab, text="Task List")        # ---------- Filter ----------        filter_frame = tk.Frame(list_tab)        filter_frame.pack(fill=tk.X, padx=10, pady=(10, 0))        tk.Label(filter_frame, text="Filter by Priority:").pack(side=tk.LEFT)        self.filter_var = tk.StringVar()        filter_combo = ttk.Combobox(            filter_frame,            textvariable=self.filter_var,            values=["All", "Low", "Medium", "High"],            state="readonly",            width=10        )        filter_combo.pack(side=tk.LEFT, padx=10)        filter_combo.current(0)        filter_combo.bind("<<ComboboxSelected>>", lambda e: self.refresh_list())        # ---------- Table ----------        columns = ("index", "id", "title", "priority", "created")        self.tree = ttk.Treeview(list_tab, columns=columns, show="headings")        self.tree.heading("index", text="#")        self.tree.heading("title", text="Title")        self.tree.heading("priority", text="Priority")        self.tree.heading("created", text="Created At")        self.tree.column("index", width=40, anchor="center")        self.tree.column("id", width=0, stretch=False)   # hidden database id        self.tree.column("title", width=220)        self.tree.column("priority", width=80, anchor="center")        self.tree.column("created", width=160)        self.tree.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)        tk.Button(            list_tab,            text="Delete Selected Task",            command=self.delete_task        ).pack(pady=(0, 10))        self.refresh_list()    # ==========================    # GUI Actions    # ==========================    def add_task(self):        title = self.title_entry.get().strip()        priority = self.priority_var.get()        if title == "":            return                new_task = Task(title = title, priority = priority)        self.toDoManager.add_task(new_task)        self.title_entry.delete(0, tk.END)        self.refresh_list()    def delete_task(self):        selected = self.tree.selection()        if not selected:            return        item = selected[0]        task_id = self.tree.item(item)["values"][1]        self.toDoManager.delete_task(task_id)        self.refresh_list()    def refresh_list(self):        # Clear table        for row in self.tree.get_children():            self.tree.delete(row)        tasks = self.toDoManager.get_all_tasks()        selected_filter = self.filter_var.get()        index = 1        for task in tasks:            if selected_filter != "All" and task.priority != selected_filter:                continue            # Format datetime: YYYY-MM-DD HH:MM            try:                dt = datetime.fromisoformat(task.created_at)                formatted_date = dt.strftime("%Y-%m-%d %H:%M")            except Exception:                formatted_date = task.created_at            self.tree.insert(                "",                tk.END,                values=(index, task.id, task.title, task.priority, formatted_date)            )            index += 1